function createWorldMap(a){new jvm.WorldMap({container:$("#world-map"),map:"world_mill_en",backgroundColor:"",regionsSelectable:!1,markersSelectable:!0,markersSelectableOne:!0,regionStyle:{hover:{"fill-opacity":.7},selected:{fill:"#F9998A"}},selectedRegions:a,markers:[{latLng:[35.9,127.76],name:"I'm here! (Korea)"}],onRegionLabelShow:function(a,b){b.html()},onRegionOver:function(){},onRegionOut:function(){},onRegionClick:function(a,b){console.log("region-click",b),$("#"+b).length>0&&(moveToPhotoSlide(b),a.stopPropagation())},onRegionSelected:function(a,b,c,d){console.log("region-select",b,c,d),window.localStorage&&window.localStorage.setItem("jvectormap-selected-regions",JSON.stringify(d))},onViewportChange:function(){}})}function setMapPosition(){var a,b;innerWidth>innerHeight?(a=.55*innerWidth,b=.55*innerHeight):(a=.65*innerWidth,b=.45*innerHeight);var c=($("#worldMapStr").width()-a)/2;$("#world-map").css({width:a,height:b,left:c})}function readJsonFromServer(){$.ajax({type:"GET",url:"http://whispering-gorge-9163.herokuapp.com/read",success:function(a){createWorldMap(JSON.parse(a).selectedCountry),countryJSON=JSON.parse(a).countries,draw(countryJSON)},error:function(a,b){console.log("error: "+a+b)}})}function writeJsonFromServer(){$.ajax({type:"POST",url:"http://whispering-gorge-9163.herokuapp.com/write",data:{selectedCountry:["BO","BR","HR","PE","CL","DE","AT","US","TR","AR"],countries:[{code:"KR",country:"Departure!",from:"2014/9/23"},{code:"US",country:"United State",from:"2014/9/23",to:"2014/10/1",cities:[{name:"San Francisco",from:"2014/9/23",to:"2014/9/26",traffic:"plane",play:"Pier 39 / Fisherman's wharf / Lombard Street / Cable Car",sleep:"Green tortoise hostel/3"},{name:"Los Angeles",from:"2014/9/26",to:"2014/10/1",traffic:"bus",play:"Universal Studios / Hollywood",sleep:"\ud558\ubaa8\ub2c8 \ud558\uc6b0\uc2a4/1"}]},{code:"PE",country:"Peru(1)",from:"2014/10/1",to:"2014/10/10",cities:[{name:"Lima",from:"2014/10/1",to:"2014/10/2",traffic:"plane",play:"",sleep:"\ud3ec\ube44\ub124/3"},{name:"Huaraz",from:"2014/10/2",to:"2014/10/8",play:"69 Lake / Pastoruri Glacier",sleep:"Akilpo/5"},{name:"Huacachina",from:"2014/10/9",to:"2014/10/10",play:"Buggy car tour",sleep:"Casa de Arena/3"},{name:"Cusco",from:"2014/10/11",to:"2014/10/16",traffic:"plane",play:"Plaza De Armas / 12 Angle Stone",sleep:"El Puma/4"},{name:"Machu Picchu",from:"2014/10/16",to:"2014/10/17",traffic:"train",play:"Machu Picchu / Huayna Picchu",sleep:"Angle Hostel/3"}]},{code:"BO",country:"Bolivia",from:"2014/10/18",to:"2014/10/28",cities:[{name:"Copacabana",from:"2014/10/18",to:"2014/10/19",play:"Isla del Sol",sleep:"Inki Kala/4"},{name:"La Paz",from:"2014/10/20",to:"2014/10/21",play:"Death Road",sleep:"Pirwa Hostel/3"},{name:"Sucre",from:"2014/10/22",to:"2014/10/25",play:"FOOD FOOD FOOD",sleep:"Pachamama Hostel/4"},{name:"Uyuni Salt Flat",from:"2014/10/25",to:"2014/10/28",play:"Uyuni Salt Flat Sunrise & Sunset",sleep:"Hotel Avenida/4"}]},{code:"CL",country:"Chile(1)",from:"2014/10/28",to:"2014/10/30",cities:[{name:"San Pedro de Atacama",from:"2014/10/28",to:"2014/10/30",play:"Valle de la Luna",sleep:"Intipara hostel/4"}]},{code:"AR",country:"Argentina(1)",from:"2014/10/30",to:"2014/11/7",cities:[{name:"Jujuy",from:"2014/10/30",to:"2014/11/3",play:"Purmamarca(Cerro de los 7 Colores) / Tilcara",sleep:"Club Hostel/4"},{name:"Salta",from:"2014/11/3",to:"2014/11/6",play:"Cafayate Tour",sleep:"La Corvacha Hostel/4"},{name:"Mendoza",from:"2014/11/7",to:"2014/11/8",play:"Wine Tour",sleep:"Hostel independencia/3"}]},{code:"CL",country:"Chile(2)",from:"2014/11/8",to:"2014/11/24",cities:[{name:"Santiago",from:"2014/11/8",to:"2014/11/10",play:"\ubcfc\uac70\uc5c6\uc74c",sleep:"Hostel Backpackers/3"},{name:"Puc\xf3n",from:"2014/11/11",to:"2014/11/14",play:"Volcan Villarrica / Hydro Speed",sleep:"ChiliKiwi/4"}]},{code:"AR",country:"Argentina(2)",from:"2014/11/13",to:"2014/12/10",cities:[{name:"Bariloche",from:"2014/11/13",to:"2014/11/16",play:"",sleep:"Penthouse 1004/4"},{name:"El Calafate",from:"2014/11/17",to:"2014/11/19",play:"Moreno Glacier",sleep:"Mochilero/3"}]},{code:"CL",country:"Chile(3)",from:"2014/11/20",to:"2014/11/25",cities:[{name:"Puerto Natales",from:"2014/11/20",to:"2014/11/21",play:"",sleep:"Kaweskar/4"},{name:"Torres del Paine",from:"2014/11/21",to:"2014/11/24",play:"W Trakking",sleep:"Refugio"}]},{code:"AR",country:"Argentina(3)",from:"2014/11/25",to:"2014/12/9",cities:[{name:"El Calafate",from:"2014/11/25",to:"2014/11/29",play:"Moreno Glacier",sleep:"Mochilero/3"},{name:"Buenos Aires",from:"2014/11/29",to:"2014/12/6",traffic:"plane",play:"",sleep:"\uc0bc\ucd0c\ub124/4"},{name:"Iguazu",from:"2014/12/7",to:"2014/12/9",play:"",sleep:""}]},{code:"PE",country:"Peru(2)",from:"2014/12/9",to:"2015/2/4",cities:[{name:"Lima",from:"2014/12/9",to:"2014/12/10",traffic:"plane",play:"",sleep:""},{name:"Huaraz",from:"2014/12/11",to:"2014/2/4",play:"Churup/Laguna Willcacocha/Chavin",sleep:"Akilpo/5"}]},{code:"BR",country:"Brazil",from:"2015/2/4",to:"2015/2/8",cities:[{name:"Rio de Janeiro",from:"2015/2/4",to:"2015/2/6",traffic:"plane",play:"Corcovado/Copacabana beach",sleep:"Refugio Hostel/3"},{name:"S\xe3o Paulo",from:"2015/2/7",to:"2015/2/8",play:"",sleep:""}]},{code:"DE",country:"Germany",from:"2015/2/8",to:"2015/2/15",cities:[{name:"M\xfcnchen",from:"2015/2/9",to:"2015/2/10",traffic:"plane",play:"",sleep:"MEININGER Hotel/3"},{name:"Fussen",from:"2015/2/10",to:"2015/2/10",traffic:"train",play:"Neuschwanstein Castle",sleep:""}]},{code:"AT",country:"Austria",from:"2015/2/11",to:"2015/2/14",cities:[{name:"Salzburg",from:"2015/2/11",to:"2015/2/13",play:"Mirabell Palace/Salzburg Cathedral",sleep:"Yoho Hostel/4"},{name:"Hallstatt",from:"2015/2/13",to:"2015/2/14",play:"",sleep:"Seehotel Gr\xfcner Baum/4"}]},{code:"HR",country:"Croatia",from:"2015/2/15",to:"2015/2/24",cities:[{name:"Zagreb",from:"2015/2/15",to:"2015/2/16",traffic:"plane",play:"",sleep:"Hostel Sara/4"},{name:"Split",from:"2015/2/16",to:"2015/2/20",play:"",sleep:"SleepinnSplit/5"},{name:"Dubrovnik",from:"2015/2/20",to:"2015/2/24",play:"",sleep:"Room PlaceForYou/3"}]},{code:"TR",country:"Turkey",from:"2015/2/24",to:"2015/3/10",cities:[{name:"Cappadocia",from:"2015/2/24",to:"2015/2/27",traffic:"plane",play:"Balloon Tour",sleep:"Garden Cave Hotel/4"},{name:"Pamukkale",from:"2015/2/28",to:"2015/2/28",play:"Pamukkale",sleep:""},{name:"Fethiye",from:"2015/2/28",to:"2015/3/4",play:"Paragliding / \xd6l\xfcdeniz Beach",sleep:"Caretta apart/3"},{name:"Istanbul",from:"2015/3/4",to:"2015/3/10",traffic:"plane",play:"Sultan Ahmed Mosque / Ayasofya / Dolmabahce Palace",sleep:"Ottomarin/4"}]},{code:"KR",country:"Arrival!",from:"2015/3/11"}]},dataType:"json",success:function(){console.log("post success"),readJsonFromServer()},error:function(){console.log("post error")}})}function getMyFlightList(a){routeLength=a.length;for(var b=0;b<a.length;b++){var c=a[b];getFlightInfo(c.code,c.number,c.date,b)}}function getFlightInfo(a,b,c,d){var e="5518caa213d5f1068aade0fa25662be5",f="9e6a56a1";if(""!=a&&""!=b&&""!=c){$("#itinerary").append("<div class='flightInfo' id='itinerary_"+d+"'></div>");var g="https://api.flightstats.com/flex/schedules/rest/v1/json/flight/"+a+"/"+b+"/departing/"+c+"?appId="+f+"&appKey="+e;$.ajax({type:"GET",url:g,success:function(a){console.log("good!");var f,b=a.scheduledFlights[0],c=b.arrivalTime.split("T")[0],e=b.arrivalTime.split("T")[1].split(":")[0]+":"+b.arrivalTime.split("T")[1].split(":")[1];f=void 0!=b.arrivalTerminal?b.arrivalTerminal:"-";var g=1,h=0;a.appendix.airports[0].cityCode!=b.arrivalAirportFsCode&&(g=0,h=1);var i={airport:b.arrivalAirportFsCode,terminal:f,time:c+" "+e,country:a.appendix.airports[h].countryName,city:a.appendix.airports[h].city},j=b.departureTime.split("T")[0],k=b.departureTime.split("T")[1].split(":")[0]+":"+b.departureTime.split("T")[1].split(":")[1],l={airport:b.departureAirportFsCode,time:j+" "+k,country:a.appendix.airports[g].countryName,city:a.appendix.airports[g].city};$("#itinerary_"+d).append("<div class='departureInfo'>[ Departure ] <span class='country'>"+l.country+"</span><span class='city'>/"+l.city+"</span><p class='airportcode'>"+l.airport+"</p><p class='time'>"+l.time+"</p></div>"),$("#itinerary_"+d).append("<div class='arrivalInfo'>[ Arrival ] <span class='country'>"+i.country+"</span><span class='city'>/"+i.city+"</span><p class='airportcode'>"+i.airport+"</p><p class='time'>"+i.time+"</p><p class='terminal'>Terminal "+i.terminal+"</p></div>"),console.log("[Arrival] AirportCode: "+i.airport+" / Terminal: "+i.terminal+" / Time: "+i.time),console.log("[Departure] AirportCode: "+l.airport+" / Time: "+l.time)},error:function(){console.log("bad")}})}}function draw(a){var b=$("#section2").width(),c=200,d=0;dataSize=a.length;for(var i=1;dataSize>i;i++)if(c*i+55+55>b){d=i-1,positionOfRightCircle=d*c;var j=(b-(c*d+55))/2;$("#itinerary").css("margin","80px "+j+"px"),positionOfFirstRightLine=b-(2*j+positionOfRightCircle);break}$("#itinerary").append("<div id='plane' style='height:75px;'><img class='plane_img' src='./image/airplane_64.png'></div>"),rightDirectionMaxNumber=d,leftDirectionMaxNumber=2*d,oneRoundRange=2*d;for(var i=0;dataSize>i;i++){var k,l=!1;void 0!=a[i].city?(k=a[i].city,l=!0):k=a[i].country,rightDirectionMaxNumber>i&&leftDirectionMaxNumber>i?(drawCircle(i+1,"left_right",k,a[i].from,l),i+1!=dataSize&&drawLine(i+1,"left_right")):i==rightDirectionMaxNumber?(drawLine(i+1,"right"),i+1==dataSize?(drawLine(i+1,"right_left"),drawCircle(i+1,"right_left",k,a[i].from,l)):drawCircle(i+1,"right",k,a[i].from,l)):i>rightDirectionMaxNumber&&leftDirectionMaxNumber>i?(drawLine(i+1,"right_left"),drawCircle(i+1,"right_left",k,a[i].from,l)):i==leftDirectionMaxNumber&&(drawLine(i+1,"right_left"),drawLine(i+1,"left"),i+1==dataSize?(drawLine(i+1,"left_right"),drawCircle(i+1,"left_right",k,a[i].from,l)):(drawCircle(i+1,"left",k,a[i].from,l),drawLine(i+1,"left_right")),rightDirectionMaxNumber+=oneRoundRange,leftDirectionMaxNumber+=oneRoundRange,countR++,countL++)}highlightRoute(),mouseEventHandler()}function drawCircle(a,b,c,d){var f,g=0;"right_left"==b?f="right":"left_right"==b?f="left":"right"==b?(g=-3+lengthOfHorizontalLine/2-25,f="right"):(f="left",g=-3+lengthOfHorizontalLine/2-25),a>12?a==dataSize?$("#itinerary").append("<div id='route_"+a+"' class='circle_container' style='float:"+f+"; top:"+g+"px;'><div class='circle' style='width:50px; height:50px; background-color:#07314A;'></div><span id='circle_"+a+"' class='circle_no' style='color:white;'>"+a+"</span><div class='route_info'><div class='code'>"+c+"</div><div class='from'>"+d+"</div></div></div>"):$("#itinerary").append("<div id='route_"+a+"' class='circle_container' style='float:"+f+"; top:"+g+"px;'><div class='circle' style='width:50px; height:50px; background-color:#E7CA52;'></div><span id='circle_"+a+"' class='circle_no' style='color:#4B4646;'>"+a+"</span><div class='route_info'><div class='code'>"+c+"</div><div class='from'>"+d+"</div></div></div>"):1==a?$("#itinerary").append("<div id='route_"+a+"' class='circle_container' style='float:"+f+"; top:"+g+"px;'><div class='circle' style='width:50px; height:50px; background-color:#DD6D64;'></div><span id='circle_"+a+"' class='circle_no' style='color:#4B4646;'>"+a+"</span><div class='route_info'><div class='code'>"+c+"</div><div class='from'>"+d+"</div></div></div>"):$("#itinerary").append("<div id='route_"+a+"' class='circle_container' style='float:"+f+"; top:"+g+"px;'><div class='circle' style='width:50px; height:50px; background-color:#A5CDB3;'></div><span id='circle_"+a+"' class='circle_no' style='color:#4B4646;'>"+a+"</span><div class='route_info'><div class='code'>"+c+"</div><div class='from'>"+d+"</div></div></div>"),"right"==b?$("#route_"+a).css("right","23px"):"left"==b&&$("#route_"+a).css("left","23px")}function drawLine(a,b){if("left_right"==b)a==leftDirectionMaxNumber+1||a==dataSize?$("#itinerary").append("<div class='line_vertical_right' style='margin-left:55px;'></div>"):$("#itinerary").append("<div class='line_vertical_right'></div>");else if("right_left"==b)a==rightDirectionMaxNumber+2||a==dataSize&&rightDirectionMaxNumber+1==dataSize?$("#itinerary").append("<div class='line_vertical_left' style='margin-right:"+positionOfFirstRightLine+"px;'></div>"):$("#itinerary").append("<div class='line_vertical_left'></div>");else if("right"==b){var c=-3+$("#plane").height()+2*$(".circle_container").height()*countR;$("#itinerary").append("<div class='line_horizontal_right' style='left:"+positionOfRightCircle+"px; top:"+c+"px'></div>")}else if("left"==b){var c=-3+$("#plane").height()+$(".circle_container").height()*(2*countL+1);$("#itinerary").append("<div class='line_horizontal_left' style='top:"+c+"px; left:20px;'></div>")}}function highlightRoute(){var a=17;setInterval(function(){"rgb(255, 255, 255)"==$("#circle_"+a).css("color")?$("#circle_"+a).css("color","#4B4646"):$("#circle_"+a).css("color","white")},1e3)}function mouseEventHandler(){$(".circle_no").mouseover(function(a){switch(origin_circle_color=$("#"+a.target.id).siblings(".circle").css("background-color")){case"rgb(221, 109, 100)":hover_circle_color="rgb(219,170,167)";break;case"rgb(165, 205, 179)":hover_circle_color="rgb(205,249,221)";break;case"rgb(231, 202, 82)":hover_circle_color="rgb(250,231,152)";break;case"rgb(7, 49, 74)":hover_circle_color="rgb(67,104,125)"}$("#"+a.target.id).siblings(".circle").css("background-color",hover_circle_color)}).mouseout(function(a){$("#"+a.target.id).siblings(".circle").css("background-color",origin_circle_color)}),$(".circle_no").click(function(a){var b=$("#"+a.target.id).siblings(".route_info").children(".code").text();return hasCityInfo(b)===!0&&showDetailInfo(b),!1}),$(".close_img").click(function(){return"none"!=$("#zoom_photo_container").css("display")?hideZoomContainer():"block"==$("#detailInfo").css("display")&&($("#detailInfo").css("display","none"),$(".detail_container").remove()),!1})}function hasCityInfo(a){for(var b=0;b<countryJSON.length;b++)if(countryJSON[b].country===a&&void 0!==countryJSON[b].cities)return selectedCountry=JSON.stringify(countryJSON[b].cities),!0;return!1}function showDetailInfo(){var a=JSON.parse(selectedCountry);if("none"==$("#detailInfo").css("display")){var b=innerHeight-130,c=innerWidth-150,d=($("#section2").width()-c)/2,e=(innerHeight-40-b)/2;$("#detailInfo").css({display:"block",height:b,width:c,margin:e+"px "+d+"px"})}for(var f=a.length,g=0;f>g;g++){$("#detailInfo").append("<div id='detail_"+g+"'  class='detail_container'><div class='cityName'></div></div>"),$("#detail_"+g).children(".cityName").text(a[g].name),$("#detail_"+g).css("width",($("#detailInfo").width()-20*f-64-30)/f),$("#detail_"+g).css("height",$("#detailInfo").height()-60);var i,h=($(".detail_container").height()-$(".cityName").height()-2*parseInt($(".cityName").css("margin-top")))/3;switch(a[g].traffic){case"train":i="train20.png";break;case"plane":i="airplane_64.png";break;case"bus":default:i="bus.png"}$("#detail_"+g).append("<div class='cityContent traffic' style='height:"+(h-10)+"px'><img class='titleImg' src='./image/black_flat_icons/"+i+"'><div class='term'>"+a[g].from.substring(5)+" ~ "+a[g].to.substring(5)+"</div></div>"),$("#detail_"+g).append("<div class='cityContent attraction' style='height:"+(h+20)+"px'><img class='titleImg' src='./image/black_flat_icons/map_64.png'><div class='term'>"+a[g].play+"</div></div>");var j="";if(a[g].sleep.split("/")[0])for(var k=a[g].sleep.split("/")[1],l=0;k>l;l++)j+="<img class='hostelScore' src='./image/star16.png'>";$("#detail_"+g).append("<div class='cityContent accommodation' style='height:"+(h-10)+"px'><img class='titleImg' src='./image/black_flat_icons/hotel_64.png'><div><span class='term hostel_name'>"+a[g].sleep.split("/")[0]+"</span>"+j+"</div></div>")}}$(document).ready(function(){writeJsonFromServer()});var countryJSON,positionOfFirstRightLine=0,positionOfRightCircle=0,rightDirectionMaxNumber,leftDirectionMaxNumber,lengthOfHorizontalLine=220,countR=0,countL=0,dataSize=0,origin_circle_color,hover_circle_color,selectedCountry;